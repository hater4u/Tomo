{% extends 'index.html' %}
{% load l10n %}

{% block body %}

<main class="container">
    <br>
    <br>

    <h3>Changing the experiment</h3>

       <form action="/experiment/change/{{ experiment.id }}/" method="post" class="experiments_form">
        {% csrf_token %}
        <div class="form-group">
            <label for="experimentName">Experiment name</label>
            <input type="text" class="form-control" id="experimentName" name="experimentName" aria-describedby="experimentNameHelp" required value="{{ experiment.name }}">
            <small id="experimentNameHelp" class="form-text text-muted">Experiment name</small>
        </div>

        <div class="form-group">
            <label for="taxonSearchName">Taxon name</label>
            <input type="text" class="form-control" id="taxonSearchName" name="taxonSearchName" aria-describedby="taxonNameHelp" required  value="{{ experiment.taxon_name }}">
            <small id="taxonNameHelp" class="form-text text-muted">Taxon name</small>
        </div>

        <div class="taxons-hierarchy">

        </div>

        <div class="form-row">
            <div class="col">
                <label class="form-check-label">Way of life: </label>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="wayOfLife" id="diurnalWayRadio" value="DIURNAL" {% if experiment.wayOfLife == 'DIURNAL' %}checked {% endif %}>
                    <label class="form-check-label" for="diurnalWayRadio">Diurnal</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="wayOfLife" id="nocturalWayRadio" value="NOCTURNAL" {% if experiment.wayOfLife == 'NOCTURNAL' %}checked {% endif %}>
                    <label class="form-check-label" for="nocturalWayRadio">Nocturnal</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="wayOfLife" id="twilightWayRadio" value="TWILIGHT" {% if experiment.wayOfLife == 'TWILIGHT' %}checked {% endif %}>
                    <label class="form-check-label" for="twilightWayRadio">Twilight</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="wayOfLife" id="otherWayRadio" value="OTHER" {% if experiment.wayOfLife == 'OTHER' %}checked {% endif %}>
                    <label class="form-check-label" for="otherWayRadio">Other</label>
                </div>
            </div>


            <div class="col">
                <label class="form-check-label">Habitat: </label>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="habitat" id="wildHabitatRadio" value="WILD" {% if experiment.habitat == 'WILD' %}checked {% endif %}>
                    <label class="form-check-label" for="wildHabitatRadio">Wild</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="habitat" id="laboratoryHabitatRadio" value="LABORATORY" {% if experiment.habitat == 'LABORATORY' %}checked {% endif %}>
                    <label class="form-check-label" for="laboratoryHabitatRadio">Laboratory</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="habitat" id="farmHabitatRadio" value="FARM" {% if experiment.habitat == 'FARM' %}checked {% endif %}>
                    <label class="form-check-label" for="farmHabitatRadio">Farm</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="habitat" id="otherHabitatRadio" value="OTHER" {% if experiment.habitat == 'OTHER' %}checked {% endif %}>
                    <label class="form-check-label" for="otherHabitatRadio">Other</label>
                </div>
            </div>


            <div class="col">


                <label class="form-check-label">Gender: </label>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="gender" id="maleGenderRadio" value="MALE" {% if experiment.gender == 'MALE' %}checked {% endif %}>
                    <label class="form-check-label" for="maleGenderRadio">Male</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="gender" id="femaleGenderRadioRadio" value="FEMALE" {% if experiment.gender == 'FEMALE' %}checked {% endif %}>
                    <label class="form-check-label" for="femaleGenderRadioRadio">Female</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="gender" id="otherGenderRadio" value="OTHER" {% if experiment.gender == 'OTHER' %}checked {% endif %}>
                    <label class="form-check-label" for="otherGenderRadio">Other</label>
                </div>
            </div>
        </div>

        <br>
        <br>

        <div class="form-row">
            <div class="col">
                <label for="monthsAge">Age</label>
                <input type="number" class="form-control" min="0" id="monthsAge" name="monthsAge" aria-describedby="monthsAgeHelp" value="{{ experiment.monthsAge }}" required>
                <small id="monthsAgeHelp" class="form-text text-muted">Age in months</small>
            </div>

            <div class="col">
                <label for="weight">Weight</label>
                <input type="number" step="0.01" class="form-control" min="0" id="weight" name="weight" aria-describedby="weightHelp" value="{{ experiment.weight|unlocalize }}" required>
                <small id="weightHelp" class="form-text text-muted">Weight in kilograms</small>
            </div>

            <div class="col">
                <label for="length">Length</label>
                <input type="number" step="0.01" class="form-control" min="0" id="length" name="length" aria-describedby="lengthHelp" value="{{ experiment.length|unlocalize }}" required>
                <small id="lengthHelp" class="form-text text-muted">Length in centimeters</small>
            </div>
        </div>

        <br>
        <br>


        <div class="form-row">
            <div class="col">
                <h6>Environmental factors</h6>
                <div class="environmentalFactors">

                    {% for el in experiment.environmentalFactors %}
                        <div>
                            <label for="environmentalFactor{{ forloop.counter }}"> Factor {{ forloop.counter }}</label>
                            <input type="text" class="form-control" id="environmentalFactor{{ forloop.counter }}" name="environmentalFactors" value="{{ el }}" required>
                        </div>
                    {% endfor %}

                </div>
                <br>
                <div class="btn btn-success btn-sm" onclick="addAdditionalField(this)" data-inputtype="environmentalFactors">Add one more factor</div>
                <div class="btn btn-danger btn-sm" onclick="deleteLastField(this)" data-inputtype="environmentalFactors">Remove the last factor</div>
            </div>
            <div class="col">
                <h6>Diseases</h6>
                <div class="diseases">

                    {% for el in experiment.diseases %}
                        <div>
                            <label for="disease{{ forloop.counter }}"> Disease {{ forloop.counter }}</label>
                            <input type="text" class="form-control" id="disease{{ forloop.counter }}" name="diseases" value="{{ el }}" required>
                        </div>

                    {% endfor %}

                </div>
                <br>
                <div class="btn btn-success btn-sm" onclick="addAdditionalField(this)" data-inputtype="diseases">Add another disease</div>
                <div class="btn btn-danger btn-sm" onclick="deleteLastField(this)" data-inputtype="diseases">Remove the last disease</div>
            </div>
        </div>

        <br>
        <br>


        <div class="form-row">
            <div class="col">
                <label for="withdrawPlace">Withdraw place</label>
                <input type="text" class="form-control" id="withdrawPlace" name="withdrawPlace" aria-describedby="withdrawPlaceHelp" value="{{ experiment.withdrawPlace }}">
                <small id="withdrawPlaceHelp" class="form-text text-muted">String</small>
            </div>
            <div class="col">
                <label for="withdrawDate">Withdraw date</label>
                <input type="date" class="form-control" id="withdrawDate" name="withdrawDate" aria-describedby="withdrawDateHelp" value="{{ experiment.withdrawDate }}">
                <small id="withdrawDateHelp" class="form-text text-muted">Date starting at 00:00:00 of the selected day</small>
            </div>
        </div>

        <br>


        <div class="form-row">
            <div class="col">
                <h6>Withdraw conditions</h6>
                <div class="withdrawConditions">

                    {% for el in experiment.withdrawConditions %}
                        <div>
                            <label for="withdrawCondition{{ forloop.counter }}"> Withdraw condition {{ forloop.counter }}</label>
                            <input type="text" class="form-control" id="withdrawCondition{{ forloop.counter }}" name="withdrawConditions" value="{{ el }}" required>
                        </div>
                    {% endfor %}

                </div>
                <br>
                <div class="btn btn-success btn-sm" onclick="addAdditionalField(this)" data-inputtype="withdrawConditions">Add one more withdraw condition</div>
                <div class="btn btn-danger btn-sm" onclick="deleteLastField(this)" data-inputtype="withdrawConditions">Remove the last withdraw condition</div>
            </div>
            <div class="col">
                <h6>Comments</h6>
                <div class="comments">

                    {% for el in experiment.comments %}
                        <div>
                            <label for="comment{{ forloop.counter }}"> Comment {{ forloop.counter }}</label>
                            <input type="text" class="form-control" id="comment{{ forloop.counter }}" name="comments" value="{{ el }}" required>
                        </div>

                    {% endfor %}

                </div>
                <br>
                <div class="btn btn-success btn-sm" onclick="addAdditionalField(this)" data-inputtype="comments">Add another comment</div>
                <div class="btn btn-danger btn-sm" onclick="deleteLastField(this)" data-inputtype="comments">Remove the last comment</div>
            </div>
        </div>
        <br>
        <br>


        <div class="form-row">
            <div class="col">
                <label for="hoursPostMortem">Hours post mortem</label>
                <input type="number" class="form-control" min="0" id="hoursPostMortem" name="hoursPostMortem" aria-describedby="hoursPostMortemHelp" value="{{ experiment.hoursPostMortem }}" required>
                <small id="hoursPostMortemHelp" class="form-text text-muted">Time in hours</small>
            </div>
            <div class="col">
                <label for="temperature">Temperature</label>
                <input type="number" step="0.01" class="form-control" min="0" id="temperature" name="temperature" aria-describedby="temperatureHelp" value="{{ experiment.temperature|unlocalize }}" required>
                <small id="temperatureHelp" class="form-text text-muted">Value in degrees Celsius</small>
            </div>
        </div>

        <div class="form-group">
            <h6>Additional properties</h6>
            <div class="additionalProperties">

                {% for key, value in experiment.additionalProperties.items %}
                    <div class="form-row">
                        <div class="col">
                            <label for="propKey{{ forloop.counter }}"> Key {{ forloop.counter }}</label>
                            <input type="text" class="form-control" id="propKey{{ forloop.counter }}" data-hiddenid="hiddenFieldId{{ forloop.counter }}" value="{{ key }}" required>
                        </div>

                        <div class="col">
                            <label for="propValue{{ forloop.counter }}"> Value {{ forloop.counter }}</label>
                            <input type="text" class="form-control" id="propValue{{ forloop.counter }}" data-hiddenid="hiddenFieldId{{ forloop.counter }}" value="{{ value }}" required>
                        </div>
                        <input id="hiddenFieldId{{ forloop.counter }}" type="hidden" data-keyvalue="true">
                    </div>

                {% endfor %}
            </div>
            <br>
        </div>

        <div class="btn btn-success btn-sm" onclick="addAdditionalField(this)" data-inputtype="additionalProperties">Add one more property</div>
        <div class="btn btn-danger btn-sm" onclick="deleteLastField(this)" data-inputtype="additionalProperties">Remove the last property</div>

        <br>
        <br>


        <div class="form-group">
            <h6>Metabolites</h6>
            <div class="metabolites">
                {% for el in experiment.metabolites %}
                    <div class="form-row">
                        <div class="col-6 col-md-3">
                            <label for="pubChemCid{{ forloop.counter }}"> pubChemCid {{ forloop.counter }}</label>
                            <input type="number" min="0" class="form-control" id="pubChemCid{{ forloop.counter }}" name="pubChemCid{{ forloop.counter }}" data-metabolite="true" value="{{ el.pubChemCid }}" required>
                        </div>

                        <div class="col-6 col-md-3">
                            <label for="metaName{{ forloop.counter }}"> Metabolite name {{ forloop.counter }}</label>
                            <input type="text" class="form-control" id="metaName{{ forloop.counter }}" name="metaName{{ forloop.counter }}" data-metabolite="true" value="{{ el.name }}" required>
                        </div>

                        <div class="col-6 col-md-3">
                            <label for="concentration{{ forloop.counter }}"> Concentration {{ forloop.counter }}</label>
                            <input type="number" min="0" step="0.01" class="form-control" id="concentration{{ forloop.counter }}" name="concentration{{ forloop.counter }}" data-metabolite="true" value="{{ el.concentration|unlocalize }}" required>
                        </div>

                        <div class="col-6 col-md-3">
                            <label for="analysisMethod{{ forloop.counter }}"> Analysis method name {{ forloop.counter }}</label>
                            <input type="text" class="form-control" id="analysisMethod{{ forloop.counter }}" name="analysisMethod{{ forloop.counter }}" data-metabolite="true" value="{{ el.analysisMethod }}" required>
                        </div>
                    </div>

                {% endfor %}
            </div>
            <br>
            <div class="btn btn-success btn-sm" onclick="addAdditionalField(this)" data-inputtype="metabolites">Add another metabolite</div>
            <div class="btn btn-danger btn-sm" onclick="deleteLastField(this)" data-inputtype="metabolites">Remove the last metabolite</div>
        </div>

        <br>
        <br>

        <div class="form-row">
            <div class="col">
                <h6>Filepaths</h6>
                <div class="filepaths">

                    {%  for el in experiment.fileInfos %}

                        <div aria-label="breadcrumb">
                            <input type="hidden" id="filepath{{ forloop.counter }}" name="filepaths" value="{{ el.filepath }}">
                            <label>path {{ forloop.counter }}</label>
                            <ol id="bc{{ forloop.counter }}" class="breadcrumb bc-ol" data-id="{{ forloop.counter }}">
                                <li class="breadcrumb-item">Root</li>
                            </ol>
                            <div class="filesdirs{{ forloop.counter }}"></div>
                        </div>

                    {% endfor %}
                </div>
                <br>
                <div class="btn btn-success btn-sm" onclick="addAdditionalField(this)" data-inputtype="filepaths">Add one more filepath</div>
                <div class="btn btn-danger btn-sm" onclick="deleteLastField(this)" data-inputtype="filepaths">Remove the last filepath</div>
            </div>

            <div class="col"></div>
        </div>

        <br>
        <br>
        <div class="response">
        {% if success != None %}
        {% if success %}
        <div class="alert alert-success">
            {{ message }}
        </div>
        {% else %}
        <div class="alert alert-danger">
            {{ message }}
        </div>
        {% endif %}
        {% endif %}
        </div>

        <button type="submit" class="btn btn-primary">Change</button>

    </form>

    <br>
    <br>


</main>

{% endblock %}